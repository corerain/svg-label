(function(e){function t(t){for(var n,o,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);h&&h(t);while(p.length)p.shift()();return s.push.apply(s,c||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,r=1;r<i.length;r++){var l=i[r];0!==a[l]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=i[0]))}return e}var n={},a={app:0},s=[];function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=n,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(i,n,function(t){return e[t]}.bind(null,n));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var h=l;s.push(["e35a","chunk-vendors"]),i()})({1579:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAC6ElEQVRIS6WUXUiTYRTHz2mrCeKSimbixS5sTARR30SdF34NoqV0kSA1I1bbTcFmmwSauHTUrvaikYFsUwJLBoEwXCMmQhBKnwMvHA4vvBjyEiK0NUSpnXjGu9Bw0F4PPDfvx/93zv885yAcM4ioBAAmRZn7iJg6KInH0SeiS8lkcm50dLSS6Tidzg2lUnkDEb/kdCUBiIj951hdXX3S399/SqfTZfWWl5dhfHx8v6am5hEAeBAx+2FBQUQqInrp8/kue71eGBkZSXV1dd1jIgsLCy/GxsZKLBYLmM3md4h4WwpgwuVyWaPRKPA8/1mtVt9ExA0GIKLKzc3N13a7vaG+vh6Gh4efSQF0zs7OLjKAx+O5iohvD1pARAaHwxGqq6uDvr4+vRSAXBAEwWAwnF1ZWfEVFRVZDgJ2d3e9Op3OHA6Ht1Uq1YWCAaIV/t7e3jsWi2Vbr9eXIeJv8bksEokIPp/vXCAQmEbEu1IBhpmZmVA8Hge32/0KAHbEKs4MDg4aNRoNmEymrH1SAacSicT3jo6O0wqF4tAt3Nvbg6WlpR8VFRXnEXFfEkC0YyKdTl8hokMARITi4uIwItrYi4IBRKQFgC1ETP7PABUEYKshnU5/lMvlvxQKxQcACLGDiOv5YIUCLgqCENfr9dDc3Azt7e3Q1tYG5eXlbNCyMAB4z7yXvIuIaL27u1uztrb2N2mtVpuFsVNbW/tTJpNFRNhcQRWIzeV5nn8wOZnb0IfNKS0thdbWVrBaraBWq59KAXRGo9HFnp6eI21vaWkBm80GHMfFAOCWFMDJTCaz3djYqNzZyc0XQFNTE9jt9pywCwACiJgpGCDa9GZgYOD6/Px8tgpmid/vTyDiw5yw5CaLAFMoFJpmPrMIBoNQXV19DRGD//omtQJVKpXa4jjuBLs5U1NT3xCRO6opkgBiFZ+MRmPD0NBQ3uwlrYpclkTkjMVij6uqqvJmf1xAGQC4AeA5In7Ntyr+AFzCOcRxpY93AAAAAElFTkSuQmCC"},"1ada":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAB5ElEQVRIS62UPahSYRjH//803MKhKBxCgkJxEU5xFAeV6yoNuUlDxB39SKTBpSCoTQRzkLA1gguC4FQQQWAG5abciIaIi9DFxVwifOKV4+0Snts9r+eBZzjD+/s9H+95CZdDRAjgPMkfCq0+XAsL/gxAWiXJb64J1vDhcHh3MBigXC5/BRBzRXAcXigU0Gw2YZpmB8Du1oIT4eRqIdrxP/hWSz4NXFtwWriWwAlcV3ABwPtGo3ElHo//vS2kbFqm1pJF5DKAN1bu0gau20EIwAEAH4DDk+COBSJyfbFYDL1e72+fz/cOQF8lyX27u+5oRCJydTqdfs5kMlDzT6fTSKVSCAQCX9YyAG9J/loLHQnUIRHZz2az18bj8VHRoVBoJVMZjUZ/ejyeV5bwhY6gXq/X77VarY1T8fv9SCaTKBaLCAaDj3UEO6PR6HUul9soSCQSKJVKMAxjAuC2juDscrk8NE3z3Gw2O5LEYjFUKpU1+BGAlySXjgXWHvaq1eqtbre7EqiRdDqd7yTvr8HaS7YEd/r9/nM1ZxW9Xg+RSOQmyd6/c9Pt4OJ8Pj8wDOOMujntdvsTScO1p8Lq4kM+n79Rq9Vsq3f8Jx+vUEQeTCaTh+Fw2Lb6bQWXADwB8JTkR7un4g/UIPPiAxLdpAAAAABJRU5ErkJggg=="},a9cd:function(e,t,i){},ca8f:function(e,t,i){"use strict";var n=i("ff52"),a=i.n(n);a.a},d5db:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAABpUlEQVRIS+2UsUsCURzHv7803MKtcBKkOHERrlBxUMlVGnKThv4BJZEGl4KgtptycLA1gkA4uMmWoKWg3DyM3EIcwiFzibgXz+4kykPvroagH7zp/d7v8/193+89go1gjLFZj9GsiZ/zOCAQCEw92ul04AjAC5gFF/AjACL6JtLo8B/w4fGft+hXp2jaQ3A0RdOKG/uWHxpjTADQJaLnWSCWAIyx1eFweO12u988Hs8VAIUvImqbwawClnu93n06nUYsFkMqlUIymYTP53swYAAuiejViUXtTCaz0mq1xqIFQRjB+AqHwy8ul6uhA08tdcArMsYkSZJ2KpXKRFe8Xi8SiQTy+Tz8fv+hHcB6s9m8yGazEwHxeByFQgGiKKoAtuwA5jVNe4pEIgv9fn8MiUajKBaLRuEDAGdEpFkG6Dadl0qlzXq9PgJwS2q12iMR7RqFbV+yDthWFOWE+8xDlmWEQqENIpK/+ma3g8XBYNAVRXGOT061Wr0jInHSpdgC6F3c5HK5tXK5bKqe5zkB7Kmquh8MBk3VOwUsATgCcExEt2ZfxTstRPimxnbipQAAAABJRU5ErkJggg=="},d678:function(e,t,i){"use strict";var n=i("a9cd"),a=i.n(n);a.a},df8e:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAACG0lEQVRIS82VP6hSYRjGnzcNp3t1K5xEKBRBhXNDRfDPzTFpSFCRhpzEQUkODTYURLdFnFJ00FWFQLCciiLJoahEB+VGnCkuDiF4zSXCLz45XigU8lyEPviWMzy/933e53sPYceHzqPPGLsBIAPgQNb5CCBPRC9WuooBjLHHkiRlc7kcut3uUs/tdkMURRiNxiMius+/KQLwyiVJeh6JRBCPxxGNRpeAWq2GarWKer3OIUHeiVLA62Qy6bdarUgkEn+4XCqVMBgMUCwW3xDRoVLAqc1m2+t0OtBqtQiHw0tIo9HAdDqFx+NBv9+fEdH+fwvYuUW7HTL3e6cxXcVmJw+NMWYCcEJEp/+yBbZKEWPsYD6fv1er1b80Gs07AG1+ieh4E2xbwJXxePwlEAjA5XLB7/fD5/NBr9d/XcEAvCWin4p3EWPsOBgMXh0Oh2dFm0ymJYxfu93+Q6VSvZSBta06kNOTz+fzdwuFwlpXdDodvF4vUqkUDAbDkRLA9V6v9yoUCq0F8I2aTqchCMIIwG0lgIuLxeK7w+HYn0wmZxCn04lMJrMSfsRXExEttgbINj0TRfFWs9lcArgllUrlGxHdWwkrHrIMuNNut6vcZ35arRYsFstNImr97ZvSDi7NZrMTQRAu8OSUy+XPRCSsG4oigNzFh1gsdi2bzW6sXvEvUwY8GI1GD81m88bqzwu4DOAJgKdE9GnTqvgNsA0Q4YZW24oAAAAASUVORK5CYII="},e35a:function(e,t,i){"use strict";i.r(t);var n=i("2b0e"),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("div",{staticClass:"test-demo-page"},[i("div",{staticClass:"test-demo-page-content"},[i("SvgLabel",{attrs:{img:e.img,"is-lock":!1,"init-data":e.initData,upload:e.upload}})],1)])])},s=[],o=(i("96cf"),i("1da1")),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"roi-container bsizing"},[e.img&&!e.imgIsLoadErr?n("div",{staticClass:"has-img"},[e.tools.length&&e.drawTools.length?n("header",{staticClass:"header flex-v-c bsizing"},[e._l(e.drawTools,(function(t,i){return n("div",{key:t.type,class:["draw-shape tool-item bsizing","draw-shape-"+t.type,i===e.drawTools.length-1?"draw-shape-last":"",e.isLock?"disabled":""],on:{click:function(i){return e.handleDraw(t.type)}}},[n("el-tooltip",{attrs:{effect:"dark",content:t.text,placement:"top"}},[n("div",{class:["tool-item-wrapper flex-v-c bsizing",t.type===e.shape?"active":""]},[n("div",{class:["tool-icon","tool-item-"+t.type+"-icon"]})])])],1)})),e._l(e.tools,(function(t){return n("div",{key:t.type,class:["operate-tool-item tool-item bsizing","tool-item-"+t.type],on:{click:function(i){return e.handleSelectTool(t.type)}}},["progressBar"===t.type?n("el-slider",{attrs:{min:e.minScale,max:e.maxScale,step:e.step,"format-tooltip":e.formatTooltip},on:{change:e.setScale},model:{value:e.scale,callback:function(t){e.scale=t},expression:"scale"}}):"changeBg"===t.type?n("div",{staticClass:"flex-v-c"},[n("el-dropdown",{attrs:{placement:"bottom"},on:{command:e.handleChangeBg}},[n("div",{staticClass:"tool-item-bg tool-item-wrapper"},[n("div",{class:["tool-icon","tool-item-"+t.type+"-icon"]})]),n("el-dropdown-menu",{staticClass:"cus-dropdown-menu-drop",attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.bgList,(function(t){return n("el-dropdown-item",{key:t.type,class:[e.curBg===t.type?"active":""],attrs:{command:t.type}},[n("div",{staticClass:"bg-text"},[e._v(e._s(t.name))]),n("div",{class:["bg-icon","bg-icon-"+t.type]})])})),1)],1)],1):"safe"===t.type?n("div",{staticClass:"safe flex-v-c"},[e._v(" "+e._s(t.text)+" "),n("el-switch",{attrs:{size:"small",width:30,"active-color":"#1872f0","inactive-color":"rgba(27, 53, 89, 0.25)"},on:{change:e.handleSwitchSafe},model:{value:e.isShowSafe,callback:function(t){e.isShowSafe=t},expression:"isShowSafe"}})],1):"area"===t.type?n("el-tooltip",{attrs:{effect:"dark",content:t.text,placement:"top"}},[n("div",{staticClass:"tool-item-area tool-item-wrapper"},[n("div",{class:["tool-icon","tool-item-"+t.type+"-icon"]})])]):n("el-tooltip",{attrs:{effect:"dark",content:t.text,placement:"top"}},[n("div",{class:["tool-item-wrapper flex-v-c bsizing",t.type===e.mode?"active":""]},[n("div",{class:["tool-icon","tool-item-"+t.type+"-icon"]})])])],1)}))],2):e._e(),n("div",{staticClass:"roi-img bsizing"})]):e._e(),e.imgIsLoadErr?n("div",{staticClass:"img-load-err"},[n("img",{attrs:{src:i("f3a7")}})]):e._e(),n("input",{staticClass:"none upload-input",attrs:{type:"file",accept:"image/*"},on:{change:e.uploadInputChange}})])},l=[],c=(i("a9e3"),i("b64b"),i("ac1f"),i("5319"),i("99af"),i("cb29"),i("4de4"),i("4160"),i("a15b"),i("d81d"),i("fb6a"),i("159b"),i("2909")),h=i("5530"),u=i("d4ec"),p=i("bee2"),d=i("ade3"),g=i("53ca"),f=i("b85c"),v=i("15fd"),y=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},m=function(e,t){var i="http://www.w3.org/2000/svg",n=document.createElementNS(i,e),a=t.style,s=void 0===a?{}:a,o=Object(v["a"])(t,["style"]),r=Object.keys(o),l=Object.keys(s);if(l.length){var c,h="",u=Object(f["a"])(l);try{for(u.s();!(c=u.n()).done;){var p=c.value,d=s[p];d&&(h+="".concat(p,":").concat(d,";"))}}catch(b){u.e(b)}finally{u.f()}n.setAttribute("style",h)}for(var g=0,y=r;g<y.length;g++){var m=y[g],w=o[m];w&&n.setAttribute(m,w)}return n},w=function(e,t,i){if(e)if(document.addEventListener)e.addEventListener(t,i,!1);else if(document.attachEvent)e.attachEvent("on"+t,i);else{var n=e["on"+t];e["on"+t]=function(){n(),i&&i()}}},b=function(e,t,i){e&&(document.removeEventListener?e.removeEventListener(t,i):document.detachEvent?e.detachEvent("on"+t,i):e["on"+t]=null)},x=function e(t,i){if(!t&&"object"!==Object(g["a"])(t))throw new Error("error arguments","shallowClone");for(var n in i=i||(Array.isArray(t)?[]:{}),t)t.hasOwnProperty(n)&&(t[n]&&"object"===Object(g["a"])(t[n])?(i[n]=Array.isArray(t[n])?[]:{},e(t[n],i[n])):i[n]=t[n]);return i},S=function(){function e(t){var i=this;Object(u["a"])(this,e),Object(d["a"])(this,"createSvgMask",(function(e,t,n,a,s){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"rgba(248, 47, 7, 0.3)",r=i.config.el;e=e||r.querySelector(".svg-painter");var l=m("rect",{x:0,y:0,width:"100%",height:"100%",stroke:"none",fill:o,mask:"url(#svgMask)"});l.id="rect-mask";var c=m("defs",{});c.id="defs-mask";var h=m("mask",{id:"svgMask"}),u=m("rect",{x:0,y:0,width:"100%",height:"100%",stroke:"none",fill:"#fff"}),p=m("rect",{x:100*t+"%",y:100*n+"%",width:100*a+"%",height:100*s+"%",fill:"red"});h.appendChild(u),h.appendChild(p),e.appendChild(l),c.appendChild(h),e.appendChild(c)})),Object(d["a"])(this,"deleteMask",(function(e){var t=i.config.el;e=e||t.querySelector(".svg-painter");var n=e.querySelector("#rect-mask"),a=e.querySelector("#defs-mask");n&&e.removeChild(n),a&&e.removeChild(a)})),this.config={el:document.querySelector(".lbi-paint-container"),shape:"polygon",shapeIcon:{point:"",polyline:"",rect:"",polygon:""},showMask:!1,maskInfo:{x:.25,y:.25,w:.25,h:.25,color:"rgba(248, 47, 7, 0.3)"},initData:[],drawConfig:{point:{color:"#FF1717",size:4},polyline:{color:"#FF1717",size:2},rect:{color:"#FF1717",size:2,bgColor:"none"},polygon:{color:"#FF1717",size:2,bgColor:"rgba(255, 23, 23, 0.3)"},text:{color:"#FFFFFF",size:12,bgColor:"#FF1717",h:20}},w:880,h:550,type:"draw",isLock:!1,isMouseWheel:!0,minScale:.5,maxScale:5,imgOnloadCb:function(){},imgOnErr:function(){},drawEnd:function(e,t){console.log("drawEnd "+e+"：",t,"output data：",i.outputData)},handleResize:function(){}},this.config=y(this.config,t),this.x=0,this.y=0,this.imgNaturalWidth=0,this.imgNaturalHeight=0,this.styleTop=0,this.styleLeft=0,this.rectMinWidth=4,this.rectMinHeight=4,this.curShape={shape:"",els:[],points:[]},this.isDrawEnd=!0,this.scale=1,this.isBindEvent=!1,this.imgWidth=0,this.imgHeight=0,this.viewWidth=0,this.viewHeight=0,this.isLoaded=!1,this.isDrag=!1,this.outputData=[],this.init()}return Object(p["a"])(e,[{key:"init",value:function(){var e=this.config.url;e&&(this.loadStyle(),this.renderUI(),this.loadImg(this.config.url))}},{key:"loadImg",value:function(e,t){var i=this,n=this.config,a=n.el,s=n.w,o=n.h,r=n.imgOnloadCb,l=n.imgModel,c=n.showMask,h=n.maskInfo,u=a.querySelector(".lbi-img"),p=a.querySelector(".svg-painter");this.isLoaded=!1,u.src=e+"?"+ +new Date,u.onload=function(){var e=u.naturalWidth,n=u.naturalHeight;i.imgNaturalWidth=e,i.imgNaturalHeight=n;var a=i.getImgSize(s,o,e,n,l),d=a.width,g=a.height;i.viewWidth=d,i.viewHeight=g;var f=.5*(s-d),v=.5*(o-g);p.setAttribute("viewBox","0, 0, "+d+", "+g),i.changeStyle(d,g,v,f),c&&(i.deleteMask(p),i.createSvgMask(p,h.x,h.y,h.w,h.h,h.color)),r&&r(d,g),i.isLoaded=!0,t=t||i.config.initData,i.initShape(p,t,d,g),i.config.initData=[],i.isBindEvent||i.config.isLock||i.bindEvent()},u.onerror=function(){var e=i.config.imgOnErr;e&&e()}}},{key:"resize",value:function(){var e=this.config,t=e.el,i=e.handleResize;this.scale=1;var n=t.offsetWidth,a=t.offsetHeight,s=this.imgNaturalWidth,o=this.imgNaturalHeight,r=this.getImgSize(n,a,s,o),l=r.width,c=r.height;this.viewWidth=l,this.viewHeight=c;var h=(n-l)/2,u=(a-c)/2;this.changeStyle(l,c,u,h),i&&i()}},{key:"getImgSize",value:function(e,t,i,n,a){var s,o,r=e/t,l=i/n;return"cover"!==a?l>=r?(s=e,o=s*(n/i)):(o=t,s=o*l):l>=r?(o=t,s=o*l):(s=e,o=s*(n/i)),{width:s,height:o}}},{key:"setScale",value:function(e,t){if(!this.config.isLock){var i=this.config.el,n=e/this.scale,a=this.imgWidth,s=this.imgHeight,o=this.imgWidth*n,r=this.imgHeight*n,l=i.getBoundingClientRect(),c=l.left,h=l.top;t=t||{x:c+this.config.w/2,y:h+this.config.h/2};var u=this.scaleCalculationImgPos(t,o,r,a,s),p=u.top,d=u.left;this.changeStyle(o,r,p,d),this.scale=e}}},{key:"scaleCalculationImgPos",value:function(e,t,i,n,a){var s=this.config.el,o=s.querySelector(".svg-painter-box-wrapper"),r=e.x,l=e.y,c=0,h=0,u=s.getBoundingClientRect(),p=u.left,d=u.top;c=r-p,h=l-d;var g=c-o.offsetLeft,f=h-o.offsetTop;return c-=t*(g/n),h-=i*(f/a),{top:h,left:c}}},{key:"changeStyle",value:function(e,t,i,n){this.setStyleSize(e,t),this.setStylePos(i,n),this.imgWidth=e,this.imgHeight=t}},{key:"setStyleSize",value:function(e,t){var i=this.config.el,n=i.querySelector(".svg-painter-box-wrapper");n.style.width=e+"px",n.style.height=t+"px"}},{key:"setStylePos",value:function(e,t){var i=this.config.el,n=i.querySelector(".svg-painter-box-wrapper");n.style.top=e+"px",n.style.left=t+"px"}},{key:"renderUI",value:function(){var e='\n      <div class="lbi-paint-box">\n        <div class="svg-painter-box">\n          <div class="svg-painter-box-wrapper">\n            <img src="" alt="" class="lbi-img" />\n            <svg class="svg-painter"></svg>\n          </div>\n        </div>\n      </div>\n    ';this.config.el.innerHTML=e}},{key:"loadStyle",value:function(){var e=document.querySelector(".label-svg-style");if(!e){e=document.createElement("style"),e.className="label-svg-style";var t="\n        .lbi-paint-box, .svg-painter-box {\n          width: 100%;\n          height: 100%;\n          position: relative;\n        }\n        .svg-painter-box-wrapper {\n          position: absolute;\n        }\n        .lbi-img {\n          width: 100%;\n          height: 100%;\n        }\n        .svg-painter {\n          position: absolute;\n          top: 0;\n          left: 0;\n        }\n         .lbi-img {\n           box-shadow: 2px 2px 5px 0 rgb(0 0 0 / 75%);\n         }\n        .svg-painter {\n          z-index: 5;\n        }\n      ";e.innerHTML=t,document.querySelector("head").appendChild(e)}}},{key:"setType",value:function(e){this.config.type=e}},{key:"setDrawShape",value:function(e){this.config.shape=e}},{key:"bindEvent",value:function(){var e=this.config,t=e.el,i=e.isMouseWheel,n=t.querySelector(".svg-painter-box-wrapper");document.oncontextmenu=function(){return!1};var a=navigator.userAgent;/.*Firefox.*/.test(a)?i&&w(t,"DOMMouseScroll",this.mouseScroll.bind(this)):i&&w(t,"mousewheel",this.mouseScroll.bind(this)),w(t,"mouseover",this.wrapperMouseenter.bind(this)),w(t,"mouseleave",this.wrapperMouseleave.bind(this)),w(t,"mousemove",this.wrapperMousemove.bind(this)),w(n,"mousedown",this.handleMousedown.bind(this)),w(n,"mousemove",this.handleMousemove.bind(this)),w(n,"mouseup",this.handleMouseup.bind(this)),this.isBindEvent=!0}},{key:"wrapperContextmenu",value:function(){return!1}},{key:"removeEvent",value:function(){var e=this.config.el,t=e.querySelector(".svg-painter-box-wrapper");document.oncontextmenu=null,b(e,"DOMMouseScroll",this.mouseScroll),b(e,"mousewheel",this.mouseScroll),b(e,"mouseover",this.wrapperMouseenter),b(e,"mouseleave",this.wrapperMouseleave),b(e,"mousemove",this.wrapperMousemove),b(t,"mousedown",this.handleMousedown),b(t,"mousemove",this.handleMousemove),b(t,"mouseup",this.handleMouseup)}},{key:"wrapperMouseenter",value:function(){var e=this.config,t=e.el,i=e.type,n=e.shapeIcon,a=e.shape,s="crosshair";if("drag"===i)s="move";else{var o=n[a];s="url(".concat(o||"crosshair",") 12 12, auto")}t.style.cursor=s}},{key:"wrapperMouseleave",value:function(){var e=this.config,t=e.el,i=e.shape;switch(t.style.cursor="auto",this.isDrag=!1,i){case"point":break;case"rect":this.drawRectEnd();break;case"polyline":case"polygon":break;default:break}}},{key:"mouseScroll",value:function(e){e.preventDefault();var t=this.config,i=t.minScale,n=t.maxScale,a=t.setScale,s=this.scale,o=e.detail?e.detail>0:e.wheelDelta<0;o?(s-=.1,s<=i&&(s=i)):(s+=.1,s>=n&&(s=n));var r=e.clientX,l=e.clientY;return a(s),this.setScale(s,{x:r,y:l}),!1}},{key:"wrapperMousemove",value:function(){this.config.type}},{key:"handleMousedown",value:function(e){var t=this.config.type;t=t.charAt(0).toUpperCase()+t.slice(1),this["handleMousedown"+t](e)}},{key:"handleMousemove",value:function(e){var t=this.config.type;t=t.charAt(0).toUpperCase()+t.slice(1),this["handleMousemove"+t](e)}},{key:"handleMouseup",value:function(e){var t=this.config.type;t=t.charAt(0).toUpperCase()+t.slice(1),this["handleMouseup"+t](e)}},{key:"handleMousedownDrag",value:function(e){var t=e.pageX,i=e.pageY;this.x=t,this.y=i,this.isDrag=!0;var n=this.getImgStyleTopLeft(),a=n.styleTop,s=n.styleLeft;this.styleTop=a,this.styleLeft=s}},{key:"handleMousemoveDrag",value:function(e){if(this.isDrag){var t=e.pageX,i=e.pageY,n=this.styleTop+i-this.y,a=this.styleLeft+t-this.x;this.setStylePos(n,a)}}},{key:"handleMouseupDrag",value:function(){this.isDrag=!1}},{key:"handleMousedownDraw",value:function(e){var t=1/this.scale;this.x=e.offsetX*t,this.y=e.offsetY*t,this.mouseDownToDraw(e)}},{key:"mouseDownToDraw",value:function(e){var t=this.config,i=t.shape,n=t.el,a=t.drawEnd,s=n.querySelector(".svg-painter"),o=e.buttons,r=null,l=[this.x,this.y],c=n.querySelector(".cur-polyline-active");switch(i){case"point":if(2===o)return;this.isDrawEnd=!1,r=this.drawPoint(s,l);var u={els:[r],shape:"point",points:this.submitConvertData([l])};this.outputData.push(u),a&&a("point",u),this.isDrawEnd=!0,this.cleanCurShapeData();break;case"rect":if(2===o)return;this.isDrawEnd=!1;var p=this.drawRect(s,{x:this.x,y:this.y,width:0,height:0});this.curShape.els=[p],this.curShape.shape="rect";break;case"polygon":if(2===o){var d=this.curShape.els.filter((function(e){return"polyline"!==e.nodeName})),g=this.curShape.points;this.curShape=Object(h["a"])(Object(h["a"])({},this.curShape),this.curPolygonRepeal(d,g,c))}if(1===o){this.isDrawEnd=!1;var f=n.querySelector(".polygon-active-start-point");if(e.target===f){var v=this.curShape,y=v.points;if(y.length<3)alert("多边形点不够，至少3个点");else{v.els.forEach((function(e){"circle"===e.nodeName&&(e.style.display="none")})),v.els=v.els.filter((function(e){return"polyline"!==e.nodeName})),s.removeChild(c),f.classList.remove("polygon-active-start-point");var m=this.drawPolygon(s,y);v.els.push(m);var w=this.submitConvertData(y);v=Object(h["a"])(Object(h["a"])({},v),{},{points:w}),this.outputData.push(v),a&&a("polygon",v),this.isDrawEnd=!0,this.cleanCurShapeData()}}else{if(f){r=this.drawPoint(s,l);var b=f;s.removeChild(f),s.appendChild(b)}else r=this.drawPoint(s,l,{class:" polygon-active-start-point"});this.curShape.els.push(r),this.curShape.shape="polygon",this.curShape.points.push(l);var x=this.curShape.points;if(!c)return c=this.drawPolyline(s,x,{class:"cur-polyline-active"}),void this.curShape.els.push(c);c.setAttribute("points",x.join(" ")),c.setAttribute("data-position",JSON.stringify(x))}}break;case"polyline":if(1===o){this.isDrawEnd=!1,r=this.drawPoint(s,l),this.curShape.els.push(r),this.curShape.shape="polyline",this.curShape.points.push(l);var S=this.curShape.points;if(!c)return c=this.drawPolyline(s,S,{class:"cur-polyline-active"}),void this.curShape.els.push(c);c.setAttribute("points",S.join(" ")),c.setAttribute("data-position",JSON.stringify(S))}if(2===o){var A=this.curShape,k=A.points;if(k.length<2)this.removeCurShapeEls();else{A.els.forEach((function(e){"circle"===e.nodeName&&(e.style.display="none")})),c.setAttribute("points",k.join(" ")),c.classList.remove("cur-polyline-active");var C=this.submitConvertData(k);A=Object(h["a"])(Object(h["a"])({},A),{},{points:C}),this.outputData.push(A),a&&a("polyline",A)}this.isDrawEnd=!0,this.cleanCurShapeData()}break;default:break}}},{key:"handleMousemoveDraw",value:function(e){if(!this.isDrawEnd){var t=this.config,i=t.shape,n=t.el,a=1/this.scale,s=e.offsetX*a,o=e.offsetY*a,r=0,l=0,c=this.curShape.points,h=c.concat([s,o]),u=n.querySelector(".cur-polyline-active");switch(i){case"point":break;case"rect":r=s>this.x?this.x:s,l=o>this.y?this.y:o;var p=Math.abs(s-this.x),d=Math.abs(o-this.y),g=this.curShape.els[0];g.setAttribute("x",r),g.setAttribute("y",l),g.setAttribute("width",p),g.setAttribute("height",d),this.curShape.points=[[r,l],[r+p,l],[r,l+d],[r+p,l+d]];break;case"polygon":case"polyline":u&&u.setAttribute("points",h.join(" "));break;default:break}}}},{key:"handleMouseupDraw",value:function(e){var t=this.config.shape,i=e.buttons;switch(t){case"point":break;case"rect":this.drawRectEnd();break;case"polygon":break;case"polyline":2===i&&(this.isDrawEnd=!0);break;default:this.cleanCurShapeData();break}}},{key:"cleanCurShapeData",value:function(){this.curShape={els:[],shape:"",points:[]}}},{key:"removeCurShapeEls",value:function(){var e=this.curShape,t=e.els;t.forEach((function(e){e.parentNode.removeChild(e)})),this.isDrawEnd=!0,this.cleanCurShapeData()}},{key:"drawPoint",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.config,a=n.drawConfig,s=n.el,o=a.point,r=o.size,l=o.color,c=t[0],u=t[1],p={class:"",cx:c,cy:u,r:r,stroke:l,fill:l,"data-position":JSON.stringify(t)};p=Object(h["a"])(Object(h["a"])({},p),i);var d=m("circle",p);return e.appendChild(d),d.addEventListener("mouseover",(function(e){var t=e.target;t===s.querySelector(".polygon-active-start-point")&&(t.setAttribute("stroke","yellow"),t.style.strokeWidth=20),t.style.strokeWidth=10})),d.addEventListener("mouseout",(function(e){var t=e.target;t.style.strokeWidth=1,t.setAttribute("fill",l)})),d}},{key:"drawRect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.config.drawConfig,n=i.rect,a=n.size,s=n.color,o=n.bgColor,r={class:""};r=Object(h["a"])(Object(h["a"])({},r),{},{"stroke-width":a,stroke:s,fill:o},t);var l=m("rect",r);return e.appendChild(l),l}},{key:"drawRectEnd",value:function(){if(!this.isDrawEnd){var e=this.curShape,t=e.els[0],i=t.getAttribute("width"),n=t.getAttribute("height");if(i<this.rectMinWidth||n<this.rectMinHeight)t.parentNode.removeChild(t);else{e=Object(h["a"])(Object(h["a"])({},e),{},{points:this.submitConvertData(e.points)}),this.outputData.push(e);var a=this.config.drawEnd;a&&a("rect",e)}this.isDrawEnd=!0,this.cleanCurShapeData()}}},{key:"drawPolygon",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.config.drawConfig,a=n.polygon,s=a.size,o=a.color,r=a.bgColor,l={class:"",points:t.join(" "),stroke:o,"stroke-width":s,fill:r,"data-position":JSON.stringify(t)};l=Object(h["a"])(Object(h["a"])({},l),i);var c=m("polygon",l);return e.appendChild(c),c}},{key:"drawPolyline",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.config.drawConfig,a=n.polyline,s=a.size,o=a.color,r={points:t.join(" "),fill:"none",stroke:o,"stroke-width":s,"data-position":JSON.stringify(t)};r=Object(h["a"])(Object(h["a"])({},r),i);var l=m("polyline",r);return e.appendChild(l),l}},{key:"drawText",value:function(e,t,i,n,a){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=this.config.drawConfig,r=o.text,l=r.size,c=r.color,u=l,p=t.length,d=l*p;d>n&&(u=Math.floor(n/p));var g={x:i.x+.5*n,y:i.y+.5*a,fill:c,"text-anchor":"middle","dominant-baseline":"central",style:{"font-size":"".concat(u,"px")}};g=Object(h["a"])(Object(h["a"])({},g),s);var f=m("text",g);return e.appendChild(f),f.innerHTML=t,f}},{key:"getImgStyleTopLeft",value:function(){var e=this.config.el,t=e.querySelector(".svg-painter-box-wrapper"),i=parseFloat(t.style.top),n=parseFloat(t.style.left);return{styleTop:i,styleLeft:n}}},{key:"clean",value:function(){var e=this.config,t=e.el,i=e.showMask,n=e.maskInfo,a=t.querySelector(".svg-painter");this.isDrawEnd=!0,this.outputData=[],this.curShape={els:[],shape:"",points:[]},a.innerHTML="",i&&this.createSvgMask(a,n.x,n.y,n.w,n.h,n.color)}},{key:"repeal",value:function(){if(!this.config.isLock){var e=this.outputData.pop();if(e){var t=e.els;t.forEach((function(e){var t=e.parentNode;t.removeChild(e)}))}}}},{key:"getData",value:function(){return this.outputData}},{key:"curPolygonRepeal",value:function(e,t,i){var n=e.pop();return n?(n.parentNode.removeChild(n),t.pop(),i.setAttribute("points",t.join(" ")),0===e.length&&(i.parentNode.removeChild(i),this.isDrawEnd=!0,this.cleanCurShapeData()),{els:e,points:t}):{els:[],points:[]}}},{key:"submitConvertData",value:function(e){var t=this.viewWidth,i=this.viewHeight,n=[];return e.forEach((function(e){var a=e[0]/t,s=e[1]/i,o={x:a,y:s};n.push(o)})),n}},{key:"initShape",value:function(e,t,i,n){var a=this;t.forEach((function(t){var s=t.shape,o=t.points,r=t.className,l=void 0===r?"":r,u=t.attrs,p=void 0===u?{}:u,d={shape:s,points:o},g=x(o).map((function(e){return e.x*=i,e.y*=n,e})),f=null;switch(s){case"point":f=a.drawPoint(e,[g[0].x,g[0].y],p);break;case"rect":var v=g[0],y=g[3];f=a.drawRect(e,Object(h["a"])({x:v.x,y:v.y,width:y.x-v.x,height:y.y-v.y},p));break;case"polyline":g=g.map((function(e){var t=[e.x,e.y];return t})),f=a.drawPolyline(e,g,p);break;case"polygon":g=g.map((function(e){var t=[e.x,e.y];return t})),f=a.drawPolygon(e,g,p);break;case"text":f=a.drawRectText(e,t.text,g,p);break;default:break}f instanceof Array&&f.length?(f.forEach((function(e){e.setAttribute("class",l)})),d.els=Object(c["a"])(f)):(f.setAttribute("class",l),d.els=[f]),a.outputData.push(d)}))}},{key:"drawRectText",value:function(e,t,i,n){var a=i[0],s=i[1],o=this.config.drawConfig.text.h,r=n.bgColor,l=n.fill,c=s.x-a.x,h=this.drawRect(e,{x:a.x,y:a.y,width:c,height:o,fill:r,stroke:r}),u=this.drawText(e,t,a,c,o,{fill:l});return[h,u]}},{key:"dispose",value:function(){this.clean(),this.removeEvent()}}]),e}(),A=S,k=i("df8e"),C=i.n(k),E=i("1ada"),D=i.n(E),M=i("d5db"),I=i.n(M),O=i("1579"),B=i.n(O),L=function(){function e(t){Object(u["a"])(this,e),this.config={scale:16/9,el:document.querySelector(".view-box-roi"),config:{},width:320,height:180,maxWidth:0,maxHeight:0,circleSize:8,parentEl:document.querySelector(".lbi-svg-box-wrapper"),onChange:function(){}},this.config=y(this.config,t),this.isDrag=!1,this.isInCircle=!1,this.x=0,this.y=0,this.styleTop=0,this.styleLeft=0,this.elWidth=0,this.elHeight=0,this.circleEl=null,this.init()}return Object(p["a"])(e,[{key:"init",value:function(){this.loadStyle(),this.renderUI(),this.bindEvt(),this.initElSizePos()}},{key:"initElSizePos",value:function(){var e=this.config.config;if(Object.keys(e).length){var t=e.w,i=e.h,n=e.x,a=e.y;this.setSize(t,i),this.setPos(a,n),this.config.onChange(!1,t,i,n,a)}}},{key:"renderUI",value:function(){var e=this.config.el,t=e.querySelector(".view-box-container");t||(t=document.createElement("div"),t.className="view-box-container");for(var i="",n=8,a=["topLeft","topCenter","topRight","centerRight","bottomRight","bottomCenter","bottomLeft","centerLeft"],s=0;s<n;s++)i+='<span class="circle_point circle_point_'+(s+1)+'" data-func="'+a[s]+'"></span>';t.innerHTML=i,e.appendChild(t),this.config.rootEl=t;var o=this.config,r=o.maxWidth,l=o.maxHeight,c=o.width,h=o.height,u=c/r,p=h/l,d=(1-p)/2,g=(1-u)/2;this.setSize(u,p),this.setPos(d,g)}},{key:"setSize",value:function(e,t){var i=this.config.el.querySelector(".view-box-container");i.style.width=100*e+"%",i.style.height=100*t+"%",i.dataset.width=e,i.dataset.height=t}},{key:"setPos",value:function(e,t){var i=this.config.el.querySelector(".view-box-container");i.dataset.left=t,i.dataset.top=e,i.style.top=100*e+"%",i.style.left=100*t+"%"}},{key:"getElPos",value:function(){var e=this.config.el.querySelector(".view-box-container"),t=Number(e.dataset.left),i=Number(e.dataset.top),n=Number(e.dataset.width),a=Number(e.dataset.height);return{x:t,y:i,w:n,h:a}}},{key:"loadStyle",value:function(){var e=document.querySelector(".view-box");e||(e=document.createElement("style"),e.className="view-box");var t=this.config.circleSize,i=t/2,n="\n      .circle_point {\n        width: ".concat(t,"px;\n        height: ").concat(t,"px;\n        border-radius: 100%;\n        background: #fff;\n        position: absolute;\n        // display: none;\n      }\n      .circle_point_1 {\n        top: 0;\n        left: 0;\n        margin-left: -").concat(i,"px;\n        margin-top: -").concat(i,"px;\n      }\n      .circle_point_1:hover {\n        cursor: nwse-resize;\n      }\n      .circle_point_2 {\n        top: 0;\n        left: 50%;\n        margin-left: -").concat(i,"px;\n        margin-top: -").concat(i,"px;\n      }\n      .circle_point_2:hover {\n        cursor: ns-resize;\n      }\n      .circle_point_3 {\n        top: 0;\n        right: 0;\n        margin-right: -").concat(i,"px;\n        margin-top: -").concat(i,"px;\n      }\n      .circle_point_3:hover {\n        cursor: nesw-resize;\n      }\n      .circle_point_4 {\n        top: 50%;\n        right: 0;\n        margin-right: -").concat(i,"px;\n        margin-top: -").concat(i,"px;\n      }\n      .circle_point_4:hover {\n        cursor: ew-resize;\n      }\n      .circle_point_5 {\n        bottom: 0;\n        right: 0;\n        margin-right: -").concat(i,"px;\n        margin-bottom: -").concat(i,"px;\n      }\n      .circle_point_5:hover {\n        cursor: nwse-resize;\n      }\n      .circle_point_6 {\n        bottom: 0;\n        right: 50%;\n        margin-right: -").concat(i,"px;\n        margin-bottom: -").concat(i,"px;\n      }\n      .circle_point_6:hover {\n        cursor: ns-resize;\n      }\n      .circle_point_7 {\n        bottom: 0;\n        left: 0;\n        margin-left: -").concat(i,"px;\n        margin-bottom: -").concat(i,"px;\n      }\n      .circle_point_7:hover {\n        cursor: nesw-resize;\n      }\n      .circle_point_8 {\n        top: 50%;\n        left: 0;\n        margin-left: -").concat(i,"px;\n        margin-top: -").concat(i,"px;\n      }\n      .circle_point_8:hover {\n        cursor: ew-resize;\n      }\n      .view-box-container {\n        cursor: move;\n        position: absolute;\n        border: rgba(71, 118, 241, 0.6);\n        background: rgba(71, 118, 241, 0.4);\n      }\n    ");e.innerHTML=n,document.querySelector("head").appendChild(e)}},{key:"bindEvt",value:function(){var e=this.config,t=e.rootEl,i=e.parentEl;w(t,"mousedown",this.wrapperMousedown.bind(this)),w(t,"mousemove",this.wrapperMousemove.bind(this)),w(i,"mousemove",this.circleMousemove.bind(this)),w(t,"mouseup",this.wrapperMouseup.bind(this)),w(document.body,"mouseup",this.wrapperMouseup.bind(this))}},{key:"removeEvt",value:function(){var e=this.config.rootEl;e&&(b(e,"mousedown",this.wrapperMousedown),b(e,"mousemove",this.wrapperMousemove),b(e,"mouseup",this.wrapperMouseup),w(document.body,"mouseup",this.wrapperMouseup))}},{key:"wrapperMousedown",value:function(e){e.stopPropagation();var t=this.config.rootEl;if(this.x=e.pageX,this.y=e.pageY,this.styleTop=Number(t.dataset.top),this.styleLeft=Number(t.dataset.left),this.elWidth=Number(t.dataset.width),this.elHeight=Number(t.dataset.height),e.target!==t)return console.log("wrapperMousedown isInCircle"),this.isInCircle=!0,void(this.circleEl=e.target);this.isDrag=!0}},{key:"wrapperMousemove",value:function(e){var t=e.pageX,i=e.pageY,n=this.config,a=n.maxWidth,s=n.maxHeight,o=this.elWidth,r=this.elHeight,l=Number(this.styleLeft),c=Number(this.styleTop);if(this.isDrag){var h=c+(i-this.y)/s,u=l+(t-this.x)/a,p=this.isOut(o,r,h,u);h=p.top,u=p.left,this.setPos(h,u),this.config.onChange(!0,o,r,u,h)}}},{key:"wrapperMouseup",value:function(){this.isDrag=!1,this.isInCircle=!1}},{key:"circleMousemove",value:function(e){if(this.isInCircle){var t=e.pageX,i=e.pageY,n=this.config,a=n.maxWidth,s=n.maxHeight,o=this.elWidth,r=this.elHeight,l=Number(this.styleLeft),c=Number(this.styleTop),h=this.circleEl,u=h.dataset.func,p=(i-this.y)/s,d=(t-this.x)/a,g=o,f=r,v=c,y=l;switch(u){case"topLeft":g=o+-d,f*=g/o,v=c+(r-f),y=l+(o-g);break;case"topCenter":f=r+-p,g*=f/r,v=c+(r-f),y=l+(o-g)/2;break;case"topRight":g=o+d,f*=g/o,v=c+(r-f);break;case"centerRight":g=o+d,f*=g/o,v=c+(r-f)/2;break;case"bottomRight":g=o+d,f*=g/o;break;case"bottomCenter":f=r+p,g*=f/r,y=l+(o-g)/2;break;case"bottomLeft":g=o+-d,f*=g/o,y=l+(o-g);break;case"centerLeft":g=o+-d,f*=g/o,v=c+(r-f)/2,y=l+(o-g);break;default:break}this.setSize(g,f),this.setPos(v,y),this.config.onChange(!0,g,f,y,v)}}},{key:"isOut",value:function(e,t,i,n){return i=i<=0?0:i,n=n<=0?0:n,i=i+t>1?1-t:i,n=n+e>1?1-e:n,{top:i,left:n}}},{key:"dispose",value:function(){this.removeEvt();var e=this.config.el.querySelector(".view-box-container");e&&e.parentNode.removeChild(e)}}]),e}(),R=L,j={props:{img:{type:String,default:""},upload:{type:Function,default:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},initData:{type:Array,default:function(){return[{shape:"point",points:[{x:.5181818181818182,y:.1840909090909091}]},{shape:"rect",points:[{x:.33636363636363636,y:.4670454545454546},{x:.7579545454545454,y:.4670454545454546},{x:.33636363636363636,y:.697159090909091},{x:.7579545454545454,y:.697159090909091}]},{shape:"polyline",points:[{x:.12386363636363637,y:.15000000000000002},{x:.38977272727272727,y:.35625},{x:.47613636363636364,y:.2028409090909091}]},{shape:"polygon",points:[{x:.5965909090909091,y:.13977272727272727},{x:.5511363636363636,y:.34090909090909094},{x:.8022727272727272,y:.3698863636363637},{x:.7954545454545454,y:.6937500000000001},{x:.4738636363636364,y:.5607954545454545},{x:.7556818181818182,y:.1653409090909091}]}]}},tools:{type:Array,default:function(){return[{type:"drag",name:"平移",text:"平移"},{type:"repeal",name:"撤销",text:"撤销"},{type:"clean",name:"清空",text:"清空"},{type:"changeBg",name:"背景",text:"背景"},{type:"shrink",name:"缩小",text:"缩小"},{type:"progressBar",name:"进度条",text:""},{type:"magnify",name:"放大",text:"放大"},{type:"upload",name:"上传图片",text:"上传图片"}]}},drawTools:{type:Array,default:function(){return[{type:"point",name:"点",text:"点"},{type:"polyline",name:"线",text:"线"},{type:"rect",name:"矩形",text:"矩形"},{type:"polygon",name:"多边形",text:"多边形"}]}},drawEnd:{type:Function,default:function(e){console.log("drawEnd:",e)}},clean:{type:Function,default:function(){}},initShape:{type:String,default:""},isLock:{type:Boolean,default:!1},defAreaConfig:{type:Object,default:function(){return{}}},areaChange:{type:Function,default:function(){}},minScale:{type:Number,default:.5},maxScale:{type:Number,default:5}},data:function(){return{scale:1,step:.1,mode:"draw",shape:"",roiInstance:null,isLoading:!1,points:[],shapeIcon:{point:C.a,polyline:D.a,rect:I.a,polygon:B.a},isShowSafe:!1,safeMaskInfo:{x:.178,y:.17,w:.546,h:.44,color:"rgba(248, 47, 7, 0.3)"},isShowViewArea:!1,viewBox:null,imgWidth:0,imgHeight:0,isFirstLoadImg:!0,imgIsLoadErr:!1,bgList:[{name:"透明背景",type:"opacity"},{name:"黑色背景",type:"black"},{name:"白色背景",type:"white"}],curBg:"opacity"}},mounted:function(){this.img&&(this.points=x(this.initData),this.initRoi(this.img,this.initData),this.isShowViewArea=!!Object.keys(this.defAreaConfig).length)},methods:{initRoi:function(e,t){var i=this;this.isLoading=!0;var n=this.shapeIcon,a=this.$el.querySelector(".roi-img"),s=a.offsetWidth,o=a.offsetHeight,r=this.isLock,l=this.minScale,c=this.maxScale,h=r?"":this.initShape;this.roiInstance=new A({el:a,w:s,h:o,shape:h,shapeIcon:n,minScale:l,maxScale:c,imgOnloadCb:this.imgOnloadCb,imgOnErr:this.imgOnErr,url:e,isLock:r,initData:t,isMouseWheel:!0,drawEnd:this.handleDrawEnd,showMask:this.isShowSafe,maskInfo:this.safeMaskInfo,handleResize:this.handleResize,imgWidth:0,imgHeight:0,setScale:function(e){i.scale=e}})},handleResize:function(){this.scale=1},handleChangeBg:function(e){var t=this.$el.querySelector(".roi-img"),i={white:"bg-white",black:"bg-black"};t.className="roi-img bsizing","opacity"!==e&&t.classList.add(i[e])},imgOnloadCb:function(e,t){this.isLoading=!1,this.imgIsLoadErr=!1,this.imgWidth=e,this.imgHeight=t,this.isFirstLoadImg&&this.isShowViewArea?(this.initAreaViewBox(e,t),this.isFirstLoadImg=!1):(this.isShowViewArea=!1,this.viewAreaBoxDispose(),this.areaChange(!this.isFirstLoadImg,{}))},imgOnErr:function(){this.isLoading=!1,this.imgIsLoadErr=!0;var e=this.roiInstance;e&&e.dispose(),this.roiInstance=null},handleSelectTool:function(e){var t="handle"+e.replace(e[0],e[0].toUpperCase());"progressBar"!==e&&"safe"!==e&&this[t]()},handleDraw:function(e){if(this.mode="draw",this.shape!==e){this.shape=e;var t=this.roiInstance;if(t){if(this.isLock)return this.shape="",void t.setType("draw");t.setType("draw"),t.setDrawShape(e),t.removeCurShapeEls()}}},handleDrawEnd:function(e,t){var i=this.roiInstance;this.shape="",i.setType("draw"),i.setDrawShape("");var n=this.drawEnd;n&&n(t),this.points.push(t)},handleDrag:function(){this.mode="drag";var e=this.roiInstance;e&&(this.shape="",e.removeCurShapeEls(),e.setType("drag"))},handleShrink:function(){this.scale--,this.scale<=this.minScale&&(this.scale=this.minScale),this.setScale(this.scale)},handleMagnify:function(){this.scale++,this.scale>=this.maxScale&&(this.scale=this.maxScale),this.setScale(this.scale)},setImgSize:function(e){this.imgWidth*=e,this.imgHeight*=e},setScale:function(e){var t=this.roiInstance;t&&t.setScale(e)},handleUpload:function(){var e=this.$el.querySelector(".upload-input");e.click()},uploadInputChange:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function i(){var n,a;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n=e.target.files[0],e.target.value="",t.isLoading=!0,i.next=5,t.upload(n);case 5:if(a=i.sent,t.isLoading=!1,a){i.next=9;break}return i.abrupt("return");case 9:if(t.roiInstance){i.next=12;break}return t.$nextTick((function(){t.points=x(t.initData),t.initRoi(a,t.initData)})),i.abrupt("return");case 12:t.handleSwitchImg(a);case 13:case"end":return i.stop()}}),i)})))()},switchBgImg:function(e){var t=this;e&&(this.imgIsLoadErr=!1,this.roiInstance?this.handleSwitchImg(e):this.$nextTick((function(){t.points=x(t.initData),t.initRoi(e,t.initData)})))},handleSwitchImg:function(e){var t=this.roiInstance;this.scale=1,t.setScale(1),this.handleClean(),t.loadImg(e)},handleRepeal:function(){var e=this.roiInstance;e&&(e.repeal(),this.points.pop())},handleClean:function(){var e=this.roiInstance;e&&e.clean(),this.points=[];var t=this.clean;t&&t()},formatTooltip:function(e){return Math.floor(100*e)+"%"},handleSwitchSafe:function(e){var t=this.roiInstance;if(t)if(e){var i=this.safeMaskInfo,n=i.x,a=i.y,s=i.w,o=i.h,r=i.color;t.createSvgMask("",n,a,s,o,r)}else t.deleteMask()},getData:function(){return this.points},dispose:function(){var e=this.roiInstance;e&&e.dispose(),this.roiInstance=null},handleArea:function(){this.isShowViewArea=!this.isShowViewArea,this.viewBox?this.viewAreaBoxDispose():this.initAreaViewBox(this.imgWidth,this.imgHeight);var e=this.getViewAreaInfo();this.areaChange(!0,e)},initAreaViewBox:function(e,t){var i=this;this.viewAreaBoxDispose();var n=this.$el.querySelector(".lbi-svg-box-wrapper");this.viewBox=new R({el:n,maxWidth:e,maxHeight:t,config:this.defAreaConfig,onChange:function(e,t,n,a,s){i.areaViewBoxChange(e,t,n,a,s)}})},areaViewBoxChange:function(e,t,i,n,a){this.areaChange(e,{w:t,h:i,x:n,y:a})},viewAreaBoxDispose:function(){this.viewBox&&this.viewBox.dispose(),this.viewBox=null},getViewAreaInfo:function(){var e={};return e=this.viewBox?this.viewBox.getElPos():{},e}},beforeDestroy:function(){this.dispose(),this.viewAreaBoxDispose()},watch:{isLock:{handler:function(e){var t=this;this.$nextTick((function(){e||t.handleDraw(t.initShape)}))},immediate:!0}}},z=j,T=(i("ca8f"),i("2877")),F=Object(T["a"])(z,r,l,!1,null,null,null),N=F.exports,W=[{shape:"polygon",attrs:{"stroke-width":1,stroke:"rgba(255, 23, 23, 1)"},points:[{x:.20166666666666666,y:.7066666666666667},{x:.43666666666666665,y:.7},{x:.375,y:.8983333333333333},{x:.22833333333333333,y:.8966666666666666},{x:.23166666666666666,y:.83},{x:.3416666666666667,y:.7916666666666666}]},{shape:"rect",attrs:{"stroke-width":1,stroke:"rgba(255, 23, 23, 1)"},points:[{x:.5516666666666666,y:.295},{x:.6816666666666666,y:.295},{x:.5516666666666666,y:.5033333333333333},{x:.6816666666666666,y:.5033333333333333}]},{shape:"text",text:"安全帽测试",points:[{x:.5516666666666666,y:.295},{x:.6816666666666666,y:.5033333333333333}],attrs:{fill:"#ffffff",bgColor:"rgba(255, 23, 23, 1)"}},{shape:"polyline",attrs:{"stroke-width":1},points:[{x:.26,y:.26},{x:.18833333333333332,y:.4533333333333333}]},{shape:"polyline",attrs:{"stroke-width":1},points:[{x:.135,y:.51},{x:.21666666666666667,y:.6133333333333333}]},{shape:"polyline",attrs:{"stroke-width":1},points:[]},{shape:"polyline",attrs:{"stroke-width":1},points:[]},{shape:"polygon",attrs:{"stroke-width":1,stroke:"rgba(255, 23, 23, 1)"},points:[{x:.7066666666666667,y:.6533333333333333},{x:.5816666666666667,y:.8383333333333334},{x:.7616666666666667,y:.8816666666666667},{x:.8366666666666667,y:.7716666666666666},{x:.8166666666666667,y:.5483333333333333},{x:.745,y:.5266666666666666},{x:.74,y:.6133333333333333}]}],q={name:"App",components:{SvgLabel:N},data:function(){return{initData:W,img:"https://t7.baidu.com/it/u=2531125946,3055766435&fm=193&f=GIF"}},methods:{upload:function(){return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return","https://t7.baidu.com/it/u=4162611394,4275913936&fm=193&f=GIF");case 1:case"end":return e.stop()}}),e)})))()}}},H=q,P=(i("d678"),Object(T["a"])(H,a,s,!1,null,null,null)),U=P.exports,V=i("5c96"),X=i.n(V);i("0fae"),i("fa4c");n["default"].config.productionTip=!1,n["default"].use(X.a),new n["default"]({render:function(e){return e(U)}}).$mount("#app")},f3a7:function(e,t,i){e.exports=i.p+"img/roi-404.c9301d84.png"},fa4c:function(e,t,i){},ff52:function(e,t,i){}});
//# sourceMappingURL=app.e833e45e.js.map